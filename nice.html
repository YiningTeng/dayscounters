<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nice - A website to analyze products based on user information.">
    <meta name="keywords" content="Nice, product analysis, AI, Gemini, Google AI">
    <meta name="author" content="Your Name">
    <title>Nice</title>

    <!-- Structured Data for FAQPage -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How do I use the Nice tool?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "To use the Nice tool, fill in the form with your personal information (age, height, weight, sex, nationality) and click 'Confirm'. You can also upload or take a photo of a product for analysis. The tool will provide a detailed evaluation of the product based on your inputs."
        }
      }, {
        "@type": "Question",
        "name": "What is the purpose of this tool?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "This tool helps you analyze products based on your personal information. It provides a detailed evaluation of the product, including its quality, market value, and recommendations tailored to your profile."
        }
      }]
    }
    </script>

    <!-- Structured Data for HowTo -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Use the Nice Tool",
      "description": "A step-by-step guide to using the Nice tool for product analysis.",
      "step": [{
        "@type": "HowToStep",
        "text": "Fill in the form with your personal information (age, height, weight, sex, nationality)."
      }, {
        "@type": "HowToStep",
        "text": "Click 'Confirm' to update the URL with your inputs."
      }, {
        "@type": "HowToStep",
        "text": "Upload or take a photo of the product you want to analyze."
      }, {
        "@type": "HowToStep",
        "text": "Wait for the tool to analyze the photo and provide a detailed evaluation."
      }]
    }
    </script>

    <!-- Structured Data for Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Nice",
      "url": "https://www.nice.com/",
      "logo": "https://www.nice.com/logo.png",
      "description": "Nice provides tools to help users analyze products based on their personal information."
    }
    </script>

    <!-- Fonts and Styles -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        h1 {
            font-family: 'Pacifico', cursive;
            font-size: 3rem;
            color: #ff6f61;
            text-align: center;
            margin-bottom: 20px;
        }
        h1.chinese-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 4rem;
            color: #ff6f61;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            flex: 1;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }
        textarea {
            resize: vertical; /* Allow vertical resizing */
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #ff6f61;
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #ff4a3d;
        }
        .language-select {
            margin-bottom: 20px;
        }
        .language-select select {
            width: auto;
            padding: 5px;
        }
        .unit-toggle {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .unit-toggle label {
            margin-right: 10px;
        }
        .unit-toggle select {
            width: auto;
            padding: 5px;
        }
        .photo-section {
            margin-top: 20px;
        }
        .photo-section button {
            margin-bottom: 10px;
        }
        .result {
            margin-top: 20px;
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #ff6f61;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        footer {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            font-size: 0.9rem;
            color: #666;
        }
        .instructions {
            text-align: center;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="title">Nice</h1>
        <div class="instructions" id="instructions">
            This tool helps you analyze products based on your personal information. Please fill in the form and click "Confirm". After updating the URL, we recommend bookmarking it for future access.
        </div>
        <div class="language-select">
            <label for="language" id="languageLabel">Select Language:</label>
            <select id="language">
                <option value="en" data-flag="ðŸ‡ºðŸ‡¸">English</option>
                <option value="zh" data-flag="ðŸ‡¨ðŸ‡³">ä¸­æ–‡ (Chinese)</option>
                <option value="ja" data-flag="ðŸ‡¯ðŸ‡µ">æ—¥æœ¬èªž (Japanese)</option>
                <option value="ko" data-flag="ðŸ‡°ðŸ‡·">í•œêµ­ì–´ (Korean)</option>
                <option value="es" data-flag="ðŸ‡ªðŸ‡¸">EspaÃ±ol (Spanish)</option>
                <option value="fr" data-flag="ðŸ‡«ðŸ‡·">FranÃ§ais (French)</option>
                <option value="de" data-flag="ðŸ‡©ðŸ‡ª">Deutsch (German)</option>
            </select>
        </div>
        <label for="age" id="ageLabel">Age (optional):</label>
        <input type="number" id="age" min="0">
        <div class="unit-toggle">
            <label for="heightUnit" id="heightUnitLabel">Height Unit:</label>
            <select id="heightUnit">
                <option value="cm">cm</option>
                <option value="ft">ft</option>
            </select>
        </div>
        <label for="height" id="heightLabel">Height (optional):</label>
        <input type="number" id="height" min="0" placeholder="in cm">
        <div class="unit-toggle">
            <label for="weightUnit" id="weightUnitLabel">Weight Unit:</label>
            <select id="weightUnit">
                <option value="kg">kg</option>
                <option value="lb">lb</option>
            </select>
        </div>
        <label for="weight" id="weightLabel">Weight (optional):</label>
        <input type="number" id="weight" min="0" placeholder="in kg">
        <label for="sex" id="sexLabel">Sex (optional):</label>
        <select id="sex">
            <option value="">Select</option>
            <option value="male" id="sexMale">Male</option>
            <option value="female" id="sexFemale">Female</option>
            <option value="other" id="sexOther">Other</option>
        </select>
        <label for="nationality" id="nationalityLabel">Nationality (optional):</label>
        <input type="text" id="nationality">
        <label for="notes" id="notesLabel">Notes (optional):</label>
        <textarea id="notes" rows="4" placeholder="Enter any additional information..."></textarea>
        <button onclick="updateURL()" id="confirmButton">Confirm</button>

        <!-- Photo Section -->
        <div class="photo-section">
            <label id="photoLabel">Upload or Take a Photo:</label>
            <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;">
            <button onclick="document.getElementById('photoInput').click()" id="photoButton">Choose Photo</button>
        </div>

        <!-- Loading Section -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Analyzing photo, please wait...</p>
        </div>

        <!-- Result Section -->
        <div class="result" id="result"></div>
    </div>

    <!-- Footer -->
    <footer>
        &copy; 2025 CountToday All rights reserved.
        <a href="/privacy-policy.html">Privacy Policy</a> | <a href="/contact.html">Contact Us</a>
    </footer>

    <script>
        // Language translations
        const translations = {
            en: {
                title: "Nice",
                instructions: "This tool helps you analyze products based on your personal information. Please fill in the form and click \"Confirm\". After updating the URL, we recommend bookmarking it for future access.",
                languageLabel: "Select Language:",
                ageLabel: "Age (optional):",
                heightLabel: "Height (optional):",
                heightUnitLabel: "Height Unit:",
                weightLabel: "Weight (optional):",
                weightUnitLabel: "Weight Unit:",
                sexLabel: "Sex (optional):",
                sexOptions: {
                    male: "Male",
                    female: "Female",
                    other: "Other"
                },
                nationalityLabel: "Nationality (optional):",
                notesLabel: "Notes (optional):",
                notesPlaceholder: "Enter any additional information...",
                confirmButton: "Confirm",
                photoLabel: "Upload or Take a Photo:",
                photoButton: "Choose Photo",
                loadingText: "Analyzing photo, please wait..."
            },
            zh: {
                title: "ä¸é”™",
                instructions: "æœ¬å·¥å…·å¯æ ¹æ®ä¸ªäººä¿¡æ¯åˆ†æžäº§å“æ˜¯å¦åˆé€‚ä¸”ä¼˜è´¨ã€‚å¡«å†™è¡¨å•å¹¶ç‚¹å‡»â€œç¡®è®¤â€åŽæœ¬ç½‘å€ä¼šæ›´æ–°ï¼Œå»ºè®®æ‚¨æ”¶è—ä»¥ä¾¿ä¸‹æ¬¡è®¿é—®ã€‚",
                languageLabel: "é€‰æ‹©è¯­è¨€ï¼š",
                ageLabel: "å¹´é¾„ï¼ˆå¯é€‰ï¼‰ï¼š",
                heightLabel: "èº«é«˜ï¼ˆå¯é€‰ï¼‰ï¼š",
                heightUnitLabel: "èº«é«˜å•ä½ï¼š",
                weightLabel: "ä½“é‡ï¼ˆå¯é€‰ï¼‰ï¼š",
                weightUnitLabel: "ä½“é‡å•ä½ï¼š",
                sexLabel: "æ€§åˆ«ï¼ˆå¯é€‰ï¼‰ï¼š",
                sexOptions: {
                    male: "ç”·",
                    female: "å¥³",
                    other: "å…¶ä»–"
                },
                nationalityLabel: "æ°‘æ—ï¼ˆå¯é€‰ï¼‰ï¼š",
                notesLabel: "å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰ï¼š",
                notesPlaceholder: "è¾“å…¥ä»»ä½•é™„åŠ ä¿¡æ¯...",
                confirmButton: "ç¡®è®¤",
                photoLabel: "ä¸Šä¼ æˆ–æ‹æ‘„ç…§ç‰‡ï¼š",
                photoButton: "é€‰æ‹©ç…§ç‰‡",
                loadingText: "æ­£åœ¨åˆ†æžç…§ç‰‡ï¼Œè¯·ç¨å€™..."
            },
            ja: {
                title: "ã„ã„ã§ã™",
                instructions: "ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ã‚ãªãŸã®å€‹äººæƒ…å ±ã«åŸºã¥ã„ã¦è£½å“ã‚’åˆ†æžã—ã¾ã™ã€‚ãƒ•ã‚©ãƒ¼ãƒ ã«è¨˜å…¥ã—ã¦ã€Œç¢ºèªã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚URL ãŒæ›´æ–°ã•ã‚ŒãŸã‚‰ã€æ¬¡å›žã®ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã«ãƒ–ãƒƒã‚¯ãƒžãƒ¼ã‚¯ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚",
                languageLabel: "è¨€èªžã‚’é¸æŠžï¼š",
                ageLabel: "å¹´é½¢ï¼ˆä»»æ„ï¼‰ï¼š",
                heightLabel: "èº«é•·ï¼ˆä»»æ„ï¼‰ï¼š",
                heightUnitLabel: "èº«é•·å˜ä½ï¼š",
                weightLabel: "ä½“é‡ï¼ˆä»»æ„ï¼‰ï¼š",
                weightUnitLabel: "ä½“é‡å˜ä½ï¼š",
                sexLabel: "æ€§åˆ¥ï¼ˆä»»æ„ï¼‰ï¼š",
                sexOptions: {
                    male: "ç”·æ€§",
                    female: "å¥³æ€§",
                    other: "ãã®ä»–"
                },
                nationalityLabel: "å›½ç±ï¼ˆä»»æ„ï¼‰ï¼š",
                notesLabel: "å‚™è€ƒï¼ˆä»»æ„ï¼‰ï¼š",
                notesPlaceholder: "è¿½åŠ æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...",
                confirmButton: "ç¢ºèª",
                photoLabel: "å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¾ãŸã¯æ’®å½±ï¼š",
                photoButton: "å†™çœŸã‚’é¸æŠž",
                loadingText: "å†™çœŸã‚’åˆ†æžä¸­ã€ãŠå¾…ã¡ãã ã•ã„..."
            },
            ko: {
                title: "ì¢‹ì•„ìš”",
                instructions: "ì´ ë„êµ¬ëŠ” ê·€í•˜ì˜ ê°œì¸ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì œí’ˆì„ ë¶„ì„í•©ë‹ˆë‹¤. ì–‘ì‹ì„ ìž‘ì„±í•˜ê³  \"í™•ì¸\"ì„ í´ë¦­í•˜ì„¸ìš”. URLì´ ì—…ë°ì´íŠ¸ëœ í›„, ë‹¤ìŒ ì ‘ì†ì„ ìœ„í•´ ë¶ë§ˆí¬í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.",
                languageLabel: "ì–¸ì–´ ì„ íƒ:",
                ageLabel: "ë‚˜ì´ (ì„ íƒ ì‚¬í•­):",
                heightLabel: "í‚¤ (ì„ íƒ ì‚¬í•­):",
                heightUnitLabel: "í‚¤ ë‹¨ìœ„:",
                weightLabel: "ì²´ì¤‘ (ì„ íƒ ì‚¬í•­):",
                weightUnitLabel: "ì²´ì¤‘ ë‹¨ìœ„:",
                sexLabel: "ì„±ë³„ (ì„ íƒ ì‚¬í•­):",
                sexOptions: {
                    male: "ë‚¨ì„±",
                    female: "ì—¬ì„±",
                    other: "ê¸°íƒ€"
                },
                nationalityLabel: "êµ­ì  (ì„ íƒ ì‚¬í•­):",
                notesLabel: "ì°¸ê³  ì‚¬í•­ (ì„ íƒ ì‚¬í•­):",
                notesPlaceholder: "ì¶”ê°€ ì •ë³´ë¥¼ ìž…ë ¥í•˜ì„¸ìš”...",
                confirmButton: "í™•ì¸",
                photoLabel: "ì‚¬ì§„ ì—…ë¡œë“œ ë˜ëŠ” ì´¬ì˜:",
                photoButton: "ì‚¬ì§„ ì„ íƒ",
                loadingText: "ì‚¬ì§„ì„ ë¶„ì„ ì¤‘ìž…ë‹ˆë‹¤. ìž ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”..."
            },
            es: {
                title: "Bien",
                instructions: "Esta herramienta te ayuda a analizar productos basados en tu informaciÃ³n personal. Por favor, completa el formulario y haz clic en \"Confirmar\". DespuÃ©s de actualizar la URL, te recomendamos guardarla en favoritos para futuros accesos.",
                languageLabel: "Seleccionar idioma:",
                ageLabel: "Edad (opcional):",
                heightLabel: "Altura (opcional):",
                heightUnitLabel: "Unidad de altura:",
                weightLabel: "Peso (opcional):",
                weightUnitLabel: "Unidad de peso:",
                sexLabel: "Sexo (opcional):",
                sexOptions: {
                    male: "Hombre",
                    female: "Mujer",
                    other: "Otro"
                },
                nationalityLabel: "Nacionalidad (opcional):",
                notesLabel: "Notas (opcional):",
                notesPlaceholder: "Ingrese cualquier informaciÃ³n adicional...",
                confirmButton: "Confirmar",
                photoLabel: "Subir o tomar una foto:",
                photoButton: "Elegir foto",
                loadingText: "Analizando la foto, por favor espere..."
            },
            fr: {
                title: "Sympa",
                instructions: "Cet outil vous aide Ã  analyser des produits en fonction de vos informations personnelles. Veuillez remplir le formulaire et cliquer sur \"Confirmer\". AprÃ¨s la mise Ã  jour de l'URL, nous vous recommandons de l'ajouter Ã  vos favoris pour un accÃ¨s futur.",
                languageLabel: "Choisir la langue :",
                ageLabel: "Ã‚ge (facultatif) :",
                heightLabel: "Taille (facultatif) :",
                heightUnitLabel: "UnitÃ© de taille :",
                weightLabel: "Poids (facultatif) :",
                weightUnitLabel: "UnitÃ© de poids :",
                sexLabel: "Sexe (facultatif) :",
                sexOptions: {
                    male: "Homme",
                    female: "Femme",
                    other: "Autre"
                },
                nationalityLabel: "NationalitÃ© (facultatif) :",
                notesLabel: "Remarques (facultatif) :",
                notesPlaceholder: "Saisissez des informations supplÃ©mentaires...",
                confirmButton: "Confirmer",
                photoLabel: "TÃ©lÃ©charger ou prendre une photo :",
                photoButton: "Choisir une photo",
                loadingText: "Analyse de la photo en cours, veuillez patienter..."
            },
            de: {
                title: "SchÃ¶n",
                instructions: "Dieses Tool hilft Ihnen, Produkte basierend auf Ihren persÃ¶nlichen Informationen zu analysieren. Bitte fÃ¼llen Sie das Formular aus und klicken Sie auf \"BestÃ¤tigen\". Nachdem die URL aktualisiert wurde, empfehlen wir, sie fÃ¼r den zukÃ¼nftigen Zugriff zu speichern.",
                languageLabel: "Sprache auswÃ¤hlen:",
                ageLabel: "Alter (optional):",
                heightLabel: "GrÃ¶ÃŸe (optional):",
                heightUnitLabel: "GrÃ¶ÃŸeneinheit:",
                weightLabel: "Gewicht (optional):",
                weightUnitLabel: "Gewichtseinheit:",
                sexLabel: "Geschlecht (optional):",
                sexOptions: {
                    male: "MÃ¤nnlich",
                    female: "Weiblich",
                    other: "Andere"
                },
                nationalityLabel: "NationalitÃ¤t (optional):",
                notesLabel: "Notizen (optional):",
                notesPlaceholder: "Geben Sie zusÃ¤tzliche Informationen ein...",
                confirmButton: "BestÃ¤tigen",
                photoLabel: "Foto hochladen oder aufnehmen:",
                photoButton: "Foto auswÃ¤hlen",
                loadingText: "Foto wird analysiert, bitte warten..."
            }
        };

        // Function to update the page language
        function updateLanguage(lang) {
            const translation = translations[lang];
            document.getElementById('title').textContent = translation.title;
            document.getElementById('instructions').textContent = translation.instructions;
            document.getElementById('languageLabel').textContent = translation.languageLabel;
            document.getElementById('ageLabel').textContent = translation.ageLabel;
            document.getElementById('heightLabel').textContent = translation.heightLabel;
            document.getElementById('heightUnitLabel').textContent = translation.heightUnitLabel;
            document.getElementById('weightLabel').textContent = translation.weightLabel;
            document.getElementById('weightUnitLabel').textContent = translation.weightUnitLabel;
            document.getElementById('sexLabel').textContent = translation.sexLabel;
            document.getElementById('nationalityLabel').textContent = translation.nationalityLabel;
            document.getElementById('notesLabel').textContent = translation.notesLabel;
            document.getElementById('notes').placeholder = translation.notesPlaceholder;
            document.getElementById('confirmButton').textContent = translation.confirmButton;
            document.getElementById('photoLabel').textContent = translation.photoLabel;
            document.getElementById('photoButton').textContent = translation.photoButton;
            document.getElementById('loading').querySelector('p').textContent = translation.loadingText;

            // Update sex options
            document.getElementById('sexMale').textContent = translation.sexOptions.male;
            document.getElementById('sexFemale').textContent = translation.sexOptions.female;
            document.getElementById('sexOther').textContent = translation.sexOptions.other;

            // Update placeholders based on selected units
            const heightUnit = document.getElementById('heightUnit').value;
            const weightUnit = document.getElementById('weightUnit').value;
            document.getElementById('height').placeholder = `in ${heightUnit}`;
            document.getElementById('weight').placeholder = `in ${weightUnit}`;

            // Apply special font for Chinese title
            if (lang === 'zh') {
                document.getElementById('title').classList.add('chinese-title');
            } else {
                document.getElementById('title').classList.remove('chinese-title');
            }
        }

        // Function to handle language change
        document.getElementById('language').addEventListener('change', function () {
            const lang = this.value;
            localStorage.setItem('selectedLanguage', lang); // Save language to localStorage
            updateLanguage(lang);
        });

        // Function to handle height unit change
        document.getElementById('heightUnit').addEventListener('change', function () {
            const heightUnit = this.value;
            document.getElementById('height').placeholder = `in ${heightUnit}`;
        });

        // Function to handle weight unit change
        document.getElementById('weightUnit').addEventListener('change', function () {
            const weightUnit = this.value;
            document.getElementById('weight').placeholder = `in ${weightUnit}`;
        });

        // Function to update the URL with user inputs
        function updateURL() {
            const age = document.getElementById('age').value;
            const height = document.getElementById('height').value;
            const heightUnit = document.getElementById('heightUnit').value;
            const weight = document.getElementById('weight').value;
            const weightUnit = document.getElementById('weightUnit').value;
            const sex = document.getElementById('sex').value;
            const nationality = document.getElementById('nationality').value;
            const notes = document.getElementById('notes').value;

            const params = new URLSearchParams();
            if (age) params.set('age', age);
            if (height) params.set('height', `${height}${heightUnit}`);
            if (weight) params.set('weight', `${weight}${weightUnit}`);
            if (sex) params.set('sex', sex);
            if (nationality) params.set('nationality', nationality);
            if (notes) params.set('notes', notes);

            const newURL = `${window.location.origin}${window.location.pathname}?${params.toString()}`;
            window.history.pushState({}, '', newURL);
        }

        // Function to populate fields from URL parameters
        function populateFieldsFromURL() {
            const params = new URLSearchParams(window.location.search);
            document.getElementById('age').value = params.get('age') || '';
            const heightValue = params.get('height') || '';
            if (heightValue) {
                const heightUnit = heightValue.includes('ft') ? 'ft' : 'cm';
                const height = heightValue.replace(/[^0-9.]/g, '');
                document.getElementById('height').value = height;
                document.getElementById('heightUnit').value = heightUnit;
            }
            const weightValue = params.get('weight') || '';
            if (weightValue) {
                const weightUnit = weightValue.includes('lb') ? 'lb' : 'kg';
                const weight = weightValue.replace(/[^0-9.]/g, '');
                document.getElementById('weight').value = weight;
                document.getElementById('weightUnit').value = weightUnit;
            }
            document.getElementById('sex').value = params.get('sex') || '';
            document.getElementById('nationality').value = params.get('nationality') || '';
            document.getElementById('notes').value = params.get('notes') || '';
        }

        // Function to analyze the photo using Google Gemini 1.5 Pro
        async function analyzePhoto(file) {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = async () => {
                const base64Image = reader.result.split(',')[1];

                const age = document.getElementById('age').value;
                const height = document.getElementById('height').value;
                const heightUnit = document.getElementById('heightUnit').value;
                const weight = document.getElementById('weight').value;
                const weightUnit = document.getElementById('weightUnit').value;
                const sex = document.getElementById('sex').value;
                const nationality = document.getElementById('nationality').value;
                const notes = document.getElementById('notes').value;
                const language = document.getElementById('language').value;

                const prompt = `Analyze the product in this image. Provide a brief description, market evaluation, whether it is a high-quality product, and recommendations based on the following user information: Age: ${age}, Height: ${height}${heightUnit}, Weight: ${weight}${weightUnit}, Sex: ${sex}, Nationality: ${nationality}, Notes: ${notes}. Respond in ${language}. Use Markdown formatting for the response.`;

                const requestBody = {
                    contents: [
                        {
                            parts: [
                                { text: prompt },
                                {
                                    inline_data: {
                                        mime_type: file.type,
                                        data: base64Image
                                    }
                                }
                            ]
                        }
                    ]
                };

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=AIzaSyBV_OgIoOLkpr-i4iEOc4HtMzvDxLKpP-Q`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestBody)
                    });
                    const result = await response.json();
                    const analysisResult = result.candidates[0].content.parts[0].text;
                    document.getElementById('result').innerHTML = marked.parse(analysisResult); // Render Markdown
                } catch (error) {
                    console.error("Error analyzing photo:", error);
                    document.getElementById('result').innerHTML = "Failed to analyze the photo. Please try again.";
                } finally {
                    document.getElementById('loading').style.display = 'none'; // Hide loading spinner
                }
            };
        }

        // Handle photo input change
        document.getElementById('photoInput').addEventListener('change', function (event) {
            const file = event.target.files[0];
            if (file) {
                document.getElementById('loading').style.display = 'block'; // Show loading spinner
                analyzePhoto(file);
            }
        });

        // Initialize the page
        function initializePage() {
            const savedLanguage = localStorage.getItem('selectedLanguage') || 'en';
            document.getElementById('language').value = savedLanguage;
            updateLanguage(savedLanguage);
            populateFieldsFromURL();
        }

        // Run initialization when the page loads
        window.onload = initializePage;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> <!-- Markdown rendering library -->
</body>
</html>
